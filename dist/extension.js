"use strict";var w=Object.create;var u=Object.defineProperty;var E=Object.getOwnPropertyDescriptor;var C=Object.getOwnPropertyNames;var x=Object.getPrototypeOf,k=Object.prototype.hasOwnProperty;var M=(e,t)=>{for(var s in t)u(e,s,{get:t[s],enumerable:!0})},m=(e,t,s,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of C(t))!k.call(e,o)&&o!==s&&u(e,o,{get:()=>t[o],enumerable:!(r=E(t,o))||r.enumerable});return e};var y=(e,t,s)=>(s=e!=null?w(x(e)):{},m(t||!e||!e.__esModule?u(s,"default",{value:e,enumerable:!0}):s,e)),b=e=>m(u({},"__esModule",{value:!0}),e);var R={};M(R,{activate:()=>A,deactivate:()=>S});module.exports=b(R);var n=y(require("vscode"));var f=y(require("vscode"));function g(e,t={}){if(!e||typeof e!="string")return e;try{let s=e.normalize("NFD");return s=s.replace(/[\u0300-\u036f]/g,""),Array.from(s).map(r=>t[r]||r).join("")}catch{return e}}function h(e){if(!e||typeof e!="object")return f.l10n.t("Invalid mappings: Not an object.");for(let[t,s]of Object.entries(e)){if(typeof t!="string"||t.length!==1)return f.l10n.t('Invalid key: "{key}". Keys must be single characters.',{key:t});if(typeof s!="string")return f.l10n.t('Invalid value for key "${key}": "${value}". Values must be strings.',{key:t,value:s})}return""}function A(e){let t=n.commands.registerCommand("ps-replace-accents.reportIssue",async()=>n.env.openExternal(n.Uri.parse("https://github.com/playfulsparkle/vscode_ps_replace_accents/issues"))),s=n.commands.registerCommand("ps-replace-accents.replaceAccents",async()=>{try{let r=n.window.activeTextEditor;if(!r)return;let o=r.document,c=r.selections;if(o.uri.scheme!=="file"&&o.uri.scheme!=="untitled"){n.window.showErrorMessage(n.l10n.t('Cannot modify "{type}" type of document',{type:o.uri.scheme}));return}let a=n.workspace.getConfiguration("ps-replace-accents").get("specialCharacterMappings",{}),d=h(a);if(d){n.window.showErrorMessage(d);return}let p=!c.length||c.every(i=>i.isEmpty),l=!1;if(await r.edit(i=>{l=p?T(i,o,a):I(i,o,c,a)}),l){let i=p?n.l10n.t("All accented characters were replaced in the entire document."):n.l10n.t("All accented characters were replaced in the selected text.");n.window.showInformationMessage(i)}}catch(r){let o=r instanceof Error?r.message:n.l10n.t("Unknown error");n.window.showErrorMessage(n.l10n.t("Unable to replace accents: {errorMessage}. If this persists, please try reopening the file or restarting VS Code.",{errorMessage:o}))}});e.subscriptions.push(t),e.subscriptions.push(s)}function T(e,t,s){let r=!1;if(t.lineCount===0)return r;let o=1e3;for(let c=0;c<t.lineCount;c+=o){let a=Math.min(c+o-1,t.lineCount-1),d=new n.Position(c,0),p=t.lineAt(a).range.end,l=new n.Range(d,p),i=t.getText(l),v=g(i,s);i!==v&&(e.replace(l,v),r=!0)}return r}function I(e,t,s,r){let o=!1;for(let c of s)if(!c.isEmpty)for(let a=c.start.line;a<=c.end.line;a++){let d=t.lineAt(a),p=new n.Range(a===c.start.line?c.start:d.range.start,a===c.end.line?c.end:d.range.end),l=t.getText(p),i=g(l,r);l!==i&&(e.replace(p,i),o=!0)}return o}function S(){}0&&(module.exports={activate,deactivate});
